dinhthien@DESKTOP-9O4K9B3:/mnt/d/thien/model/model_mobilenet/mobilenetV2(master)$ python3 mobilenetV2_hybrid.py 
/home/dinhthien/.local/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/dinhthien/.local/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=MobileNet_V2_Weights.IMAGENET1K_V1`. You can also use `weights=MobileNet_V2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
CustomModel(
  (backbone): Sequential(
    (0): Conv2dNormActivation(
      (0): Conv2d(3, 32, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): ReLU6(inplace=True)
    )
    (1): InvertedResidual(
      (conv): Sequential(
        (0): Conv2dNormActivation(
          (0): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=32, bias=False)
          (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (2): ReLU6(inplace=True)
        )
        (1): Conv2d(32, 16, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (2): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (2): InvertedResidual(
      (conv): Sequential(
        (0): Conv2dNormActivation(
          (0): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (2): ReLU6(inplace=True)
        )
        (1): Conv2dNormActivation(
          (0): Conv2d(96, 96, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), groups=96, bias=False)
          (1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (2): ReLU6(inplace=True)
        )
        (2): Conv2d(96, 24, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (3): BatchNorm2d(24, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (3): InvertedResidual(
      (conv): Sequential(
        (0): Conv2dNormActivation(
          (0): Conv2d(24, 144, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (2): ReLU6(inplace=True)
        )
        (1): Conv2dNormActivation(
          (0): Conv2d(144, 144, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=144, bias=False)
          (1): BatchNorm2d(144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (2): ReLU6(inplace=True)
        )
        (2): Conv2d(144, 24, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (3): BatchNorm2d(24, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (4): InvertedResidual(
      (conv): Sequential(
        (0): Conv2dNormActivation(
          (0): Conv2d(24, 144, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (2): ReLU6(inplace=True)
        )
        (1): Conv2dNormActivation(
          (0): Conv2d(144, 144, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), groups=144, bias=False)
          (1): BatchNorm2d(144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (2): ReLU6(inplace=True)
        )
        (2): Conv2d(144, 32, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (3): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (5): InvertedResidual(
      (conv): Sequential(
        (0): Conv2dNormActivation(
          (0): Conv2d(32, 192, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (2): ReLU6(inplace=True)
        )
        (1): Conv2dNormActivation(
          (0): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=192, bias=False)
          (1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (2): ReLU6(inplace=True)
        )
        (2): Conv2d(192, 32, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (3): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
  )
  (se_block): SEBlock(
    (global_avg_pool): AdaptiveAvgPool2d(output_size=1)
    (fc): Sequential(
      (0): Linear(in_features=32, out_features=2, bias=False)
      (1): ReLU(inplace=True)
      (2): Linear(in_features=2, out_features=32, bias=False)
      (3): Sigmoid()
    )
  )
  (inverted_residual1): InvertedResidual(
    (conv): Sequential(
      (0): Conv2d(32, 192, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): ReLU6(inplace=True)
      (3): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=192, bias=False)
      (4): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (5): ReLU6(inplace=True)
      (6): Conv2d(192, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (7): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
  )
  (inverted_residual2): InvertedResidual(
    (conv): Sequential(
      (0): Conv2d(128, 768, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (1): BatchNorm2d(768, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): ReLU6(inplace=True)
      (3): Conv2d(768, 768, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=768, bias=False)
      (4): BatchNorm2d(768, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (5): ReLU6(inplace=True)
      (6): Conv2d(768, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (7): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
  )
  (resnet_basic1): ResNetBasicBlock(
    (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu): ReLU(inplace=True)
    (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (downsample): Sequential(
      (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
  )
  (resnet_basic2): ResNetBasicBlock(
    (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu): ReLU(inplace=True)
    (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (resnet_bottleneck1): ResNetBottleneck(
    (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
    (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
    (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu): ReLU(inplace=True)
  )
  (resnet_bottleneck2): ResNetBottleneck(
    (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
    (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
    (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu): ReLU(inplace=True)
  )
  (convnext_block): ConvNeXtBlock(
    (conv): Sequential(
      (0): Conv2d(256, 256, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=256)
      (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1))
      (3): GELU(approximate='none')
      (4): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1))
    )
  )
  (pool): AdaptiveAvgPool2d(output_size=(1, 1))
  (classifier): Sequential(
    (0): Flatten(start_dim=1, end_dim=-1)
    (1): Linear(in_features=256, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=512, out_features=256, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.3, inplace=False)
    (7): Linear(in_features=256, out_features=3, bias=True)
  )
)
/mnt/d/thien/model/model_mobilenet/mobilenetV2/mobilenetV2_hybrid.py:222: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
/mnt/d/thien/model/model_mobilenet/mobilenetV2/mobilenetV2_hybrid.py:232: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch 1/50: Train Loss: 0.7649, Train Acc: 65.71% | Val Loss: 0.3883, Val Acc: 86.26%
Epoch 2/50: Train Loss: 0.3200, Train Acc: 88.39% | Val Loss: 0.1573, Val Acc: 94.55%
Epoch 3/50: Train Loss: 0.2012, Train Acc: 92.68% | Val Loss: 0.1080, Val Acc: 96.08%
Epoch 4/50: Train Loss: 0.1404, Train Acc: 94.78% | Val Loss: 0.1111, Val Acc: 95.99%
Epoch 5/50: Train Loss: 0.1030, Train Acc: 96.24% | Val Loss: 0.0775, Val Acc: 96.89%
Epoch 6/50: Train Loss: 0.0870, Train Acc: 96.89% | Val Loss: 0.0654, Val Acc: 97.39%
Epoch 7/50: Train Loss: 0.0782, Train Acc: 97.16% | Val Loss: 0.0644, Val Acc: 97.12%
Epoch 8/50: Train Loss: 0.0598, Train Acc: 97.91% | Val Loss: 0.2128, Val Acc: 92.88%
Epoch 9/50: Train Loss: 0.0611, Train Acc: 97.94% | Val Loss: 0.0864, Val Acc: 97.16%
Epoch 10/50: Train Loss: 0.0444, Train Acc: 98.37% | Val Loss: 0.0553, Val Acc: 97.61%
Epoch 11/50: Train Loss: 0.0357, Train Acc: 98.58% | Val Loss: 0.0589, Val Acc: 97.93%
Epoch 12/50: Train Loss: 0.0341, Train Acc: 98.91% | Val Loss: 0.0477, Val Acc: 98.06%
Epoch 13/50: Train Loss: 0.0352, Train Acc: 98.81% | Val Loss: 0.0511, Val Acc: 98.15%
Epoch 14/50: Train Loss: 0.0256, Train Acc: 99.09% | Val Loss: 0.0613, Val Acc: 97.97%
Epoch 15/50: Train Loss: 0.0234, Train Acc: 99.19% | Val Loss: 0.0524, Val Acc: 98.29%
Epoch 16/50: Train Loss: 0.0109, Train Acc: 99.61% | Val Loss: 0.0419, Val Acc: 98.42%
Epoch 17/50: Train Loss: 0.0215, Train Acc: 99.28% | Val Loss: 0.0471, Val Acc: 98.33%
Epoch 18/50: Train Loss: 0.0143, Train Acc: 99.55% | Val Loss: 0.1299, Val Acc: 96.85%
Epoch 19/50: Train Loss: 0.0151, Train Acc: 99.53% | Val Loss: 0.0577, Val Acc: 98.20%
Epoch 20/50: Train Loss: 0.0088, Train Acc: 99.74% | Val Loss: 0.0475, Val Acc: 98.24%
Epoch 21/50: Train Loss: 0.0039, Train Acc: 99.92% | Val Loss: 0.0662, Val Acc: 98.33%
Epoch 22/50: Train Loss: 0.0068, Train Acc: 99.79% | Val Loss: 0.0555, Val Acc: 98.56%
Epoch 23/50: Train Loss: 0.0056, Train Acc: 99.82% | Val Loss: 0.0449, Val Acc: 98.60%
Epoch 24/50: Train Loss: 0.0043, Train Acc: 99.84% | Val Loss: 0.0408, Val Acc: 98.56%
Epoch 25/50: Train Loss: 0.0032, Train Acc: 99.92% | Val Loss: 0.0667, Val Acc: 97.97%
Epoch 26/50: Train Loss: 0.0024, Train Acc: 99.92% | Val Loss: 0.0579, Val Acc: 98.60%
Epoch 27/50: Train Loss: 0.0022, Train Acc: 99.95% | Val Loss: 0.0916, Val Acc: 98.20%
Epoch 28/50: Train Loss: 0.0033, Train Acc: 99.89% | Val Loss: 0.0835, Val Acc: 98.69%
Epoch 29/50: Train Loss: 0.0002, Train Acc: 100.00% | Val Loss: 0.0814, Val Acc: 98.60%
Epoch 30/50: Train Loss: 0.0012, Train Acc: 99.95% | Val Loss: 0.0749, Val Acc: 98.42%
Epoch 31/50: Train Loss: 0.0013, Train Acc: 99.99% | Val Loss: 0.0680, Val Acc: 98.56%
Epoch 32/50: Train Loss: 0.0015, Train Acc: 99.95% | Val Loss: 0.0585, Val Acc: 98.65%
Epoch 33/50: Train Loss: 0.0027, Train Acc: 99.93% | Val Loss: 0.0603, Val Acc: 98.51%
Epoch 34/50: Train Loss: 0.0004, Train Acc: 100.00% | Val Loss: 0.0647, Val Acc: 98.56%
Epoch 35/50: Train Loss: 0.0012, Train Acc: 99.97% | Val Loss: 0.0421, Val Acc: 98.69%
Epoch 36/50: Train Loss: 0.0010, Train Acc: 99.95% | Val Loss: 0.0620, Val Acc: 98.65%
Epoch 37/50: Train Loss: 0.0005, Train Acc: 99.98% | Val Loss: 0.0675, Val Acc: 98.69%
Epoch 38/50: Train Loss: 0.0004, Train Acc: 99.98% | Val Loss: 0.0687, Val Acc: 98.56%
Epoch 39/50: Train Loss: 0.0011, Train Acc: 99.95% | Val Loss: 0.0541, Val Acc: 98.74%
Epoch 40/50: Train Loss: 0.0002, Train Acc: 99.99% | Val Loss: 0.0570, Val Acc: 98.74%
Epoch 41/50: Train Loss: 0.0001, Train Acc: 100.00% | Val Loss: 0.0556, Val Acc: 98.65%
Epoch 42/50: Train Loss: 0.0001, Train Acc: 100.00% | Val Loss: 0.0536, Val Acc: 98.78%
Epoch 43/50: Train Loss: 0.0002, Train Acc: 99.99% | Val Loss: 0.0741, Val Acc: 98.74%
Epoch 44/50: Train Loss: 0.0008, Train Acc: 99.99% | Val Loss: 0.0585, Val Acc: 98.78%
Epoch 45/50: Train Loss: 0.0010, Train Acc: 99.99% | Val Loss: 0.0661, Val Acc: 98.74%
Epoch 46/50: Train Loss: 0.0000, Train Acc: 100.00% | Val Loss: 0.0569, Val Acc: 98.65%
Epoch 47/50: Train Loss: 0.0010, Train Acc: 99.98% | Val Loss: 0.0817, Val Acc: 98.69%
Epoch 48/50: Train Loss: 0.0000, Train Acc: 100.00% | Val Loss: 0.0690, Val Acc: 98.78%
Epoch 49/50: Train Loss: 0.0001, Train Acc: 100.00% | Val Loss: 0.0793, Val Acc: 98.74%
Epoch 50/50: Train Loss: 0.0001, Train Acc: 99.99% | Val Loss: 0.0730, Val Acc: 98.74%
====================================================================================================
Layer (type:depth-idx)                             Output Shape              Param #
====================================================================================================
CustomModel                                        [1, 3]                    --
├─Sequential: 1-1                                  [1, 32, 28, 28]           --
│    └─Conv2dNormActivation: 2-1                   [1, 32, 112, 112]         --
│    │    └─Conv2d: 3-1                            [1, 32, 112, 112]         (864)
│    │    └─BatchNorm2d: 3-2                       [1, 32, 112, 112]         (64)
│    │    └─ReLU6: 3-3                             [1, 32, 112, 112]         --
│    └─InvertedResidual: 2-2                       [1, 16, 112, 112]         --
│    │    └─Sequential: 3-4                        [1, 16, 112, 112]         (896)
│    └─InvertedResidual: 2-3                       [1, 24, 56, 56]           --
│    │    └─Sequential: 3-5                        [1, 24, 56, 56]           (5,136)
│    └─InvertedResidual: 2-4                       [1, 24, 56, 56]           --
│    │    └─Sequential: 3-6                        [1, 24, 56, 56]           (8,832)
│    └─InvertedResidual: 2-5                       [1, 32, 28, 28]           --
│    │    └─Sequential: 3-7                        [1, 32, 28, 28]           (10,000)
│    └─InvertedResidual: 2-6                       [1, 32, 28, 28]           --
│    │    └─Sequential: 3-8                        [1, 32, 28, 28]           (14,848)
├─SEBlock: 1-2                                     [1, 32, 28, 28]           --
│    └─AdaptiveAvgPool2d: 2-7                      [1, 32, 1, 1]             --
│    └─Sequential: 2-8                             [1, 32]                   --
│    │    └─Linear: 3-9                            [1, 2]                    64
│    │    └─ReLU: 3-10                             [1, 2]                    --
│    │    └─Linear: 3-11                           [1, 32]                   64
│    │    └─Sigmoid: 3-12                          [1, 32]                   --
├─InvertedResidual: 1-3                            [1, 128, 28, 28]          --
│    └─Sequential: 2-9                             [1, 128, 28, 28]          --
│    │    └─Conv2d: 3-13                           [1, 192, 28, 28]          6,144
│    │    └─BatchNorm2d: 3-14                      [1, 192, 28, 28]          384
│    │    └─ReLU6: 3-15                            [1, 192, 28, 28]          --
│    │    └─Conv2d: 3-16                           [1, 192, 28, 28]          1,728
│    │    └─BatchNorm2d: 3-17                      [1, 192, 28, 28]          384
│    │    └─ReLU6: 3-18                            [1, 192, 28, 28]          --
│    │    └─Conv2d: 3-19                           [1, 128, 28, 28]          24,576
│    │    └─BatchNorm2d: 3-20                      [1, 128, 28, 28]          256
├─InvertedResidual: 1-4                            [1, 128, 28, 28]          --
│    └─Sequential: 2-10                            [1, 128, 28, 28]          --
│    │    └─Conv2d: 3-21                           [1, 768, 28, 28]          98,304
│    │    └─BatchNorm2d: 3-22                      [1, 768, 28, 28]          1,536
│    │    └─ReLU6: 3-23                            [1, 768, 28, 28]          --
│    │    └─Conv2d: 3-24                           [1, 768, 28, 28]          6,912
│    │    └─BatchNorm2d: 3-25                      [1, 768, 28, 28]          1,536
│    │    └─ReLU6: 3-26                            [1, 768, 28, 28]          --
│    │    └─Conv2d: 3-27                           [1, 128, 28, 28]          98,304
│    │    └─BatchNorm2d: 3-28                      [1, 128, 28, 28]          256
├─ResNetBasicBlock: 1-5                            [1, 256, 28, 28]          --
│    └─Conv2d: 2-11                                [1, 256, 28, 28]          294,912
│    └─BatchNorm2d: 2-12                           [1, 256, 28, 28]          512
│    └─ReLU: 2-13                                  [1, 256, 28, 28]          --
│    └─Conv2d: 2-14                                [1, 256, 28, 28]          589,824
│    └─BatchNorm2d: 2-15                           [1, 256, 28, 28]          512
│    └─Sequential: 2-16                            [1, 256, 28, 28]          --
│    │    └─Conv2d: 3-29                           [1, 256, 28, 28]          32,768
│    │    └─BatchNorm2d: 3-30                      [1, 256, 28, 28]          512
│    └─ReLU: 2-17                                  [1, 256, 28, 28]          --
├─ResNetBasicBlock: 1-6                            [1, 256, 28, 28]          --
│    └─Conv2d: 2-18                                [1, 256, 28, 28]          589,824
│    └─BatchNorm2d: 2-19                           [1, 256, 28, 28]          512
│    └─ReLU: 2-20                                  [1, 256, 28, 28]          --
│    └─Conv2d: 2-21                                [1, 256, 28, 28]          589,824
│    └─BatchNorm2d: 2-22                           [1, 256, 28, 28]          512
│    └─ReLU: 2-23                                  [1, 256, 28, 28]          --
├─ResNetBottleneck: 1-7                            [1, 256, 28, 28]          --
│    └─Conv2d: 2-24                                [1, 64, 28, 28]           16,384
│    └─BatchNorm2d: 2-25                           [1, 64, 28, 28]           128
│    └─ReLU: 2-26                                  [1, 64, 28, 28]           --
│    └─Conv2d: 2-27                                [1, 64, 28, 28]           36,864
│    └─BatchNorm2d: 2-28                           [1, 64, 28, 28]           128
│    └─ReLU: 2-29                                  [1, 64, 28, 28]           --
│    └─Conv2d: 2-30                                [1, 256, 28, 28]          16,384
│    └─BatchNorm2d: 2-31                           [1, 256, 28, 28]          512
│    └─ReLU: 2-32                                  [1, 256, 28, 28]          --
├─ResNetBottleneck: 1-8                            [1, 256, 28, 28]          --
│    └─Conv2d: 2-33                                [1, 64, 28, 28]           16,384
│    └─BatchNorm2d: 2-34                           [1, 64, 28, 28]           128
│    └─ReLU: 2-35                                  [1, 64, 28, 28]           --
│    └─Conv2d: 2-36                                [1, 64, 28, 28]           36,864
│    └─BatchNorm2d: 2-37                           [1, 64, 28, 28]           128
│    └─ReLU: 2-38                                  [1, 64, 28, 28]           --
│    └─Conv2d: 2-39                                [1, 256, 28, 28]          16,384
│    └─BatchNorm2d: 2-40                           [1, 256, 28, 28]          512
│    └─ReLU: 2-41                                  [1, 256, 28, 28]          --
├─ConvNeXtBlock: 1-9                               [1, 256, 28, 28]          --
│    └─Sequential: 2-42                            [1, 256, 28, 28]          --
│    │    └─Conv2d: 3-31                           [1, 256, 28, 28]          12,800
│    │    └─BatchNorm2d: 3-32                      [1, 256, 28, 28]          512
│    │    └─Conv2d: 3-33                           [1, 1024, 28, 28]         263,168
│    │    └─GELU: 3-34                             [1, 1024, 28, 28]         --
│    │    └─Conv2d: 3-35                           [1, 256, 28, 28]          262,400
├─AdaptiveAvgPool2d: 1-10                          [1, 256, 1, 1]            --
├─Sequential: 1-11                                 [1, 3]                    --
│    └─Flatten: 2-43                               [1, 256]                  --
│    └─Linear: 2-44                                [1, 512]                  131,584
│    └─ReLU: 2-45                                  [1, 512]                  --
│    └─Dropout: 2-46                               [1, 512]                  --
│    └─Linear: 2-47                                [1, 256]                  131,328
│    └─ReLU: 2-48                                  [1, 256]                  --
│    └─Dropout: 2-49                               [1, 256]                  --
│    └─Linear: 2-50                                [1, 3]                    771
====================================================================================================
Total params: 3,324,163
Trainable params: 3,283,523
Non-trainable params: 40,640
Total mult-adds (G): 2.46
====================================================================================================
Input size (MB): 0.60
Forward/backward pass size (MB): 135.88
Params size (MB): 13.30
Estimated Total Size (MB): 149.78
==================================================================================================== 
 
 
 
 dinhthien@DESKTOP-9O4K9B3:/mnt/d/thien/model/model_mobilenet/mobilenetV2(master)$ python3 mobilenetV2_hybrid.py 
/home/dinhthien/.local/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/dinhthien/.local/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=MobileNet_V2_Weights.IMAGENET1K_V1`. You can also use `weights=MobileNet_V2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
CustomModel(
  (backbone): Sequential(
    (0): Conv2dNormActivation(
      (0): Conv2d(3, 32, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): ReLU6(inplace=True)
    )
    (1): InvertedResidual(
      (conv): Sequential(
        (0): Conv2dNormActivation(
          (0): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=32, bias=False)
          (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (2): ReLU6(inplace=True)
        )
        (1): Conv2d(32, 16, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (2): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (2): InvertedResidual(
      (conv): Sequential(
        (0): Conv2dNormActivation(
          (0): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (2): ReLU6(inplace=True)
        )
        (1): Conv2dNormActivation(
          (0): Conv2d(96, 96, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), groups=96, bias=False)
          (1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (2): ReLU6(inplace=True)
        )
        (2): Conv2d(96, 24, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (3): BatchNorm2d(24, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (3): InvertedResidual(
      (conv): Sequential(
        (0): Conv2dNormActivation(
          (0): Conv2d(24, 144, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (2): ReLU6(inplace=True)
        )
        (1): Conv2dNormActivation(
          (0): Conv2d(144, 144, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=144, bias=False)
          (1): BatchNorm2d(144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (2): ReLU6(inplace=True)
        )
        (2): Conv2d(144, 24, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (3): BatchNorm2d(24, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (4): InvertedResidual(
      (conv): Sequential(
        (0): Conv2dNormActivation(
          (0): Conv2d(24, 144, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (2): ReLU6(inplace=True)
        )
        (1): Conv2dNormActivation(
          (0): Conv2d(144, 144, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), groups=144, bias=False)
          (1): BatchNorm2d(144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (2): ReLU6(inplace=True)
        )
        (2): Conv2d(144, 32, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (3): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (5): InvertedResidual(
      (conv): Sequential(
        (0): Conv2dNormActivation(
          (0): Conv2d(32, 192, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (2): ReLU6(inplace=True)
        )
        (1): Conv2dNormActivation(
          (0): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=192, bias=False)
          (1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (2): ReLU6(inplace=True)
        )
        (2): Conv2d(192, 32, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (3): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
  )
  (se_block): SEBlock(
    (global_avg_pool): AdaptiveAvgPool2d(output_size=1)
    (fc): Sequential(
      (0): Linear(in_features=32, out_features=2, bias=False)
      (1): ReLU(inplace=True)
      (2): Linear(in_features=2, out_features=32, bias=False)
      (3): Sigmoid()
    )
  )
  (inverted_residual1): InvertedResidual(
    (conv): Sequential(
      (0): Conv2d(32, 192, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): ReLU6(inplace=True)
      (3): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=192, bias=False)
      (4): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (5): ReLU6(inplace=True)
      (6): Conv2d(192, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (7): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
  )
  (inverted_residual2): InvertedResidual(
    (conv): Sequential(
      (0): Conv2d(128, 768, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (1): BatchNorm2d(768, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): ReLU6(inplace=True)
      (3): Conv2d(768, 768, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=768, bias=False)
      (4): BatchNorm2d(768, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (5): ReLU6(inplace=True)
      (6): Conv2d(768, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (7): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
  )
  (resnet_basic1): ResNetBasicBlock(
    (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu): ReLU(inplace=True)
    (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (downsample): Sequential(
      (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
  )
  (resnet_basic2): ResNetBasicBlock(
    (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu): ReLU(inplace=True)
    (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (resnet_bottleneck1): ResNetBottleneck(
    (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
    (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
    (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu): ReLU(inplace=True)
  )
  (resnet_bottleneck2): ResNetBottleneck(
    (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
    (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
    (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu): ReLU(inplace=True)
  )
  (convnext_block): ConvNeXtBlock(
    (conv): Sequential(
      (0): Conv2d(256, 256, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=256)
      (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1))
      (3): GELU(approximate='none')
      (4): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1))
    )
  )
  (pool): AdaptiveAvgPool2d(output_size=(1, 1))
  (classifier): Sequential(
    (0): Flatten(start_dim=1, end_dim=-1)
    (1): Linear(in_features=256, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=512, out_features=256, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.3, inplace=False)
    (7): Linear(in_features=256, out_features=3, bias=True)
  )
)
/mnt/d/thien/model/model_mobilenet/mobilenetV2/mobilenetV2_hybrid.py:222: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
/mnt/d/thien/model/model_mobilenet/mobilenetV2/mobilenetV2_hybrid.py:232: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch 1/50: Train Loss: 0.7874, Train Acc: 64.30% | Val Loss: 0.4091, Val Acc: 84.14%
Epoch 2/50: Train Loss: 0.3292, Train Acc: 87.42% | Val Loss: 0.2471, Val Acc: 92.79%
Epoch 3/50: Train Loss: 0.1836, Train Acc: 93.44% | Val Loss: 0.1353, Val Acc: 95.36%
Epoch 4/50: Train Loss: 0.1462, Train Acc: 94.85% | Val Loss: 0.1392, Val Acc: 94.41%
Epoch 5/50: Train Loss: 0.1137, Train Acc: 95.85% | Val Loss: 0.1021, Val Acc: 96.12%
Epoch 6/50: Train Loss: 0.0924, Train Acc: 96.78% | Val Loss: 0.1312, Val Acc: 94.86%
Epoch 7/50: Train Loss: 0.0739, Train Acc: 97.24% | Val Loss: 0.1306, Val Acc: 96.89%
Epoch 8/50: Train Loss: 0.0581, Train Acc: 97.93% | Val Loss: 0.0668, Val Acc: 97.66%
Epoch 9/50: Train Loss: 0.0509, Train Acc: 98.24% | Val Loss: 0.0578, Val Acc: 97.79%
Epoch 10/50: Train Loss: 0.0452, Train Acc: 98.40% | Val Loss: 0.0740, Val Acc: 97.52%
Epoch 11/50: Train Loss: 0.0397, Train Acc: 98.60% | Val Loss: 0.0829, Val Acc: 97.12%
Epoch 12/50: Train Loss: 0.0221, Train Acc: 99.14% | Val Loss: 0.0549, Val Acc: 98.06%
Epoch 13/50: Train Loss: 0.0260, Train Acc: 99.10% | Val Loss: 0.0738, Val Acc: 97.48%
Epoch 14/50: Train Loss: 0.0249, Train Acc: 99.17% | Val Loss: 0.0515, Val Acc: 97.66%
Epoch 15/50: Train Loss: 0.0259, Train Acc: 99.20% | Val Loss: 0.0732, Val Acc: 96.94%
Epoch 16/50: Train Loss: 0.0124, Train Acc: 99.55% | Val Loss: 0.0575, Val Acc: 97.84%
Epoch 17/50: Train Loss: 0.0096, Train Acc: 99.65% | Val Loss: 0.0975, Val Acc: 97.03%
Epoch 18/50: Train Loss: 0.0169, Train Acc: 99.45% | Val Loss: 0.0821, Val Acc: 97.43%
Epoch 19/50: Train Loss: 0.0089, Train Acc: 99.72% | Val Loss: 0.0651, Val Acc: 97.75%
Epoch 20/50: Train Loss: 0.0100, Train Acc: 99.72% | Val Loss: 0.0583, Val Acc: 97.79%
Epoch 21/50: Train Loss: 0.0045, Train Acc: 99.83% | Val Loss: 0.0625, Val Acc: 98.15%
Epoch 22/50: Train Loss: 0.0056, Train Acc: 99.81% | Val Loss: 0.1075, Val Acc: 97.43%
Epoch 23/50: Train Loss: 0.0050, Train Acc: 99.84% | Val Loss: 0.0855, Val Acc: 97.93%
Epoch 24/50: Train Loss: 0.0033, Train Acc: 99.88% | Val Loss: 0.0740, Val Acc: 97.84%
Epoch 25/50: Train Loss: 0.0017, Train Acc: 99.95% | Val Loss: 0.1174, Val Acc: 97.16%
Epoch 26/50: Train Loss: 0.0053, Train Acc: 99.85% | Val Loss: 0.1156, Val Acc: 97.25%
Epoch 27/50: Train Loss: 0.0013, Train Acc: 99.94% | Val Loss: 0.1029, Val Acc: 97.75%
Epoch 28/50: Train Loss: 0.0026, Train Acc: 99.95% | Val Loss: 0.0967, Val Acc: 97.75%
Epoch 29/50: Train Loss: 0.0015, Train Acc: 99.94% | Val Loss: 0.0844, Val Acc: 97.84%
Epoch 30/50: Train Loss: 0.0032, Train Acc: 99.86% | Val Loss: 0.0876, Val Acc: 97.84%
Epoch 31/50: Train Loss: 0.0009, Train Acc: 99.97% | Val Loss: 0.1192, Val Acc: 97.79%
Epoch 32/50: Train Loss: 0.0004, Train Acc: 100.00% | Val Loss: 0.0826, Val Acc: 98.11%
Epoch 33/50: Train Loss: 0.0008, Train Acc: 99.99% | Val Loss: 0.1271, Val Acc: 97.97%
Epoch 34/50: Train Loss: 0.0005, Train Acc: 99.98% | Val Loss: 0.1275, Val Acc: 97.84%
Epoch 35/50: Train Loss: 0.0007, Train Acc: 99.98% | Val Loss: 0.1387, Val Acc: 97.48%
Epoch 36/50: Train Loss: 0.0002, Train Acc: 100.00% | Val Loss: 0.1218, Val Acc: 97.75%
Epoch 37/50: Train Loss: 0.0007, Train Acc: 99.98% | Val Loss: 0.1248, Val Acc: 97.84%
Epoch 38/50: Train Loss: 0.0001, Train Acc: 100.00% | Val Loss: 0.1384, Val Acc: 97.84%
Epoch 39/50: Train Loss: 0.0002, Train Acc: 100.00% | Val Loss: 0.0927, Val Acc: 98.11%
Epoch 40/50: Train Loss: 0.0002, Train Acc: 99.99% | Val Loss: 0.1274, Val Acc: 97.84%
Epoch 41/50: Train Loss: 0.0002, Train Acc: 100.00% | Val Loss: 0.1197, Val Acc: 97.79%
Epoch 42/50: Train Loss: 0.0001, Train Acc: 100.00% | Val Loss: 0.1185, Val Acc: 97.88%
Epoch 43/50: Train Loss: 0.0002, Train Acc: 100.00% | Val Loss: 0.1191, Val Acc: 97.97%
Epoch 44/50: Train Loss: 0.0001, Train Acc: 100.00% | Val Loss: 0.0933, Val Acc: 97.88%
Epoch 45/50: Train Loss: 0.0007, Train Acc: 99.98% | Val Loss: 0.1326, Val Acc: 97.88%
Epoch 46/50: Train Loss: 0.0005, Train Acc: 99.98% | Val Loss: 0.1334, Val Acc: 97.88%
Epoch 47/50: Train Loss: 0.0008, Train Acc: 99.98% | Val Loss: 0.1157, Val Acc: 97.70%
Epoch 48/50: Train Loss: 0.0000, Train Acc: 100.00% | Val Loss: 0.1365, Val Acc: 97.88%
Epoch 49/50: Train Loss: 0.0003, Train Acc: 99.99% | Val Loss: 0.0738, Val Acc: 98.29%
Epoch 50/50: Train Loss: 0.0000, Train Acc: 100.00% | Val Loss: 0.1238, Val Acc: 97.79%
 
 
 
 dinhthien@DESKTOP-9O4K9B3:/mnt/d/thien/model/mobilenetV2$ python3 mobilenetV2.py 
2025-04-14 09:23:29.405837: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1744597409.483059   23424 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1744597409.505601   23424 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1744597409.671443   23424 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1744597409.671502   23424 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1744597409.671505   23424 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1744597409.671507   23424 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-04-14 09:23:29.691561: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Found 9620 files belonging to 3 classes.
Using 7696 files for training.
2025-04-14 09:23:38.486756: E external/local_xla/xla/stream_executor/cuda/cuda_platform.cc:51] failed call to cuInit: INTERNAL: CUDA error: Failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
Found 9620 files belonging to 3 classes.
Using 1924 files for validation.
Epoch 1/20
241/241 ━━━━━━━━━━━━━━━━━━━━ 118s 481ms/step - accuracy: 0.5033 - loss: 1.0075 - val_accuracy: 0.7734 - val_loss: 0.6261
Epoch 2/20
241/241 ━━━━━━━━━━━━━━━━━━━━ 115s 476ms/step - accuracy: 0.7642 - loss: 0.6040 - val_accuracy: 0.8415 - val_loss: 0.4552
Epoch 3/20
241/241 ━━━━━━━━━━━━━━━━━━━━ 114s 474ms/step - accuracy: 0.8323 - loss: 0.4648 - val_accuracy: 0.8737 - val_loss: 0.3787
Epoch 4/20
241/241 ━━━━━━━━━━━━━━━━━━━━ 105s 435ms/step - accuracy: 0.8661 - loss: 0.3758 - val_accuracy: 0.8888 - val_loss: 0.3221
Epoch 5/20
241/241 ━━━━━━━━━━━━━━━━━━━━ 110s 458ms/step - accuracy: 0.8863 - loss: 0.3365 - val_accuracy: 0.9002 - val_loss: 0.2805
Epoch 6/20
241/241 ━━━━━━━━━━━━━━━━━━━━ 109s 452ms/step - accuracy: 0.9033 - loss: 0.2855 - val_accuracy: 0.9137 - val_loss: 0.2533
Epoch 7/20
241/241 ━━━━━━━━━━━━━━━━━━━━ 101s 421ms/step - accuracy: 0.9198 - loss: 0.2463 - val_accuracy: 0.9205 - val_loss: 0.2302
Epoch 8/20
241/241 ━━━━━━━━━━━━━━━━━━━━ 108s 449ms/step - accuracy: 0.9282 - loss: 0.2177 - val_accuracy: 0.9283 - val_loss: 0.2102
Epoch 9/20
241/241 ━━━━━━━━━━━━━━━━━━━━ 107s 444ms/step - accuracy: 0.9322 - loss: 0.1997 - val_accuracy: 0.9345 - val_loss: 0.1988
Epoch 10/20
241/241 ━━━━━━━━━━━━━━━━━━━━ 111s 461ms/step - accuracy: 0.9395 - loss: 0.1822 - val_accuracy: 0.9397 - val_loss: 0.1811
Epoch 11/20
241/241 ━━━━━━━━━━━━━━━━━━━━ 117s 484ms/step - accuracy: 0.9451 - loss: 0.1676 - val_accuracy: 0.9423 - val_loss: 0.1739
Epoch 12/20
241/241 ━━━━━━━━━━━━━━━━━━━━ 120s 497ms/step - accuracy: 0.9582 - loss: 0.1443 - val_accuracy: 0.9459 - val_loss: 0.1669
Epoch 13/20
241/241 ━━━━━━━━━━━━━━━━━━━━ 119s 493ms/step - accuracy: 0.9585 - loss: 0.1298 - val_accuracy: 0.9418 - val_loss: 0.1652
Epoch 14/20
241/241 ━━━━━━━━━━━━━━━━━━━━ 125s 517ms/step - accuracy: 0.9634 - loss: 0.1176 - val_accuracy: 0.9491 - val_loss: 0.1501
Epoch 15/20
241/241 ━━━━━━━━━━━━━━━━━━━━ 118s 490ms/step - accuracy: 0.9631 - loss: 0.1125 - val_accuracy: 0.9449 - val_loss: 0.1530
Epoch 16/20
241/241 ━━━━━━━━━━━━━━━━━━━━ 118s 489ms/step - accuracy: 0.9687 - loss: 0.1070 - val_accuracy: 0.9475 - val_loss: 0.1477
Epoch 17/20
241/241 ━━━━━━━━━━━━━━━━━━━━ 117s 486ms/step - accuracy: 0.9670 - loss: 0.0999 - val_accuracy: 0.9496 - val_loss: 0.1406
Epoch 18/20
241/241 ━━━━━━━━━━━━━━━━━━━━ 124s 517ms/step - accuracy: 0.9706 - loss: 0.0930 - val_accuracy: 0.9454 - val_loss: 0.1480
Epoch 19/20
241/241 ━━━━━━━━━━━━━━━━━━━━ 120s 499ms/step - accuracy: 0.9758 - loss: 0.0818 - val_accuracy: 0.9465 - val_loss: 0.1424
Epoch 20/20
241/241 ━━━━━━━━━━━━━━━━━━━━ 108s 449ms/step - accuracy: 0.9760 - loss: 0.0795 - val_accuracy: 0.9511 - val_loss: 0.1303
Saved artifact at '/tmp/tmpk2_ach3e'. The following endpoints are available:

* Endpoint 'serve'
  args_0 (POSITIONAL_ONLY): TensorSpec(shape=(None, 224, 224, 3), dtype=tf.float32, name='keras_tensor')
Output Type:
  TensorSpec(shape=(None, 3), dtype=tf.float32, name=None)
Captures:
  140431594168464: TensorSpec(shape=(), dtype=tf.resource, name=None)
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
W0000 00:00:1744599716.713110   23424 tf_tfl_flatbuffer_helpers.cc:365] Ignored output_format.
W0000 00:00:1744599716.713238   23424 tf_tfl_flatbuffer_helpers.cc:368] Ignored drop_control_dependency.
2025-04-14 10:01:56.713917: I tensorflow/cc/saved_model/reader.cc:83] Reading SavedModel from: /tmp/tmpk2_ach3e
2025-04-14 10:01:56.723525: I tensorflow/cc/saved_model/reader.cc:52] Reading meta graph with tags { serve }
2025-04-14 10:01:56.723570: I tensorflow/cc/saved_model/reader.cc:147] Reading SavedModel debug info (if present) from: /tmp/tmpk2_ach3e
I0000 00:00:1744599716.805018   23424 mlir_graph_optimization_pass.cc:425] MLIR V1 optimization pass is not enabled
2025-04-14 10:01:56.817745: I tensorflow/cc/saved_model/loader.cc:236] Restoring SavedModel bundle.
2025-04-14 10:01:57.237878: I tensorflow/cc/saved_model/loader.cc:220] Running initialization op on SavedModel bundle at path: /tmp/tmpk2_ach3e
2025-04-14 10:01:57.345938: I tensorflow/cc/saved_model/loader.cc:471] SavedModel load for tags { serve }; Status: success: OK. Took 631963 microseconds.
2025-04-14 10:01:57.485922: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:269] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
Model: "functional"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                  ┃ Output Shape              ┃         Param # ┃ Connected to               ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ input_layer (InputLayer)      │ (None, 224, 224, 3)       │               0 │ -                          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ Conv1 (Conv2D)                │ (None, 112, 112, 32)      │             864 │ input_layer[0][0]          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ bn_Conv1 (BatchNormalization) │ (None, 112, 112, 32)      │             128 │ Conv1[0][0]                │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ Conv1_relu (ReLU)             │ (None, 112, 112, 32)      │               0 │ bn_Conv1[0][0]             │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_depthwise       │ (None, 112, 112, 32)      │             288 │ Conv1_relu[0][0]           │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_depthwise_BN    │ (None, 112, 112, 32)      │             128 │ expanded_conv_depthwise[0… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_depthwise_relu  │ (None, 112, 112, 32)      │               0 │ expanded_conv_depthwise_B… │
│ (ReLU)                        │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_project         │ (None, 112, 112, 16)      │             512 │ expanded_conv_depthwise_r… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_project_BN      │ (None, 112, 112, 16)      │              64 │ expanded_conv_project[0][… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_1_expand (Conv2D)       │ (None, 112, 112, 96)      │           1,536 │ expanded_conv_project_BN[… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_1_expand_BN             │ (None, 112, 112, 96)      │             384 │ block_1_expand[0][0]       │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_1_expand_relu (ReLU)    │ (None, 112, 112, 96)      │               0 │ block_1_expand_BN[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_1_pad (ZeroPadding2D)   │ (None, 113, 113, 96)      │               0 │ block_1_expand_relu[0][0]  │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_1_depthwise             │ (None, 56, 56, 96)        │             864 │ block_1_pad[0][0]          │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_1_depthwise_BN          │ (None, 56, 56, 96)        │             384 │ block_1_depthwise[0][0]    │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_1_depthwise_relu (ReLU) │ (None, 56, 56, 96)        │               0 │ block_1_depthwise_BN[0][0] │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_1_project (Conv2D)      │ (None, 56, 56, 24)        │           2,304 │ block_1_depthwise_relu[0]… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_1_project_BN            │ (None, 56, 56, 24)        │              96 │ block_1_project[0][0]      │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_2_expand (Conv2D)       │ (None, 56, 56, 144)       │           3,456 │ block_1_project_BN[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_2_expand_BN             │ (None, 56, 56, 144)       │             576 │ block_2_expand[0][0]       │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_2_expand_relu (ReLU)    │ (None, 56, 56, 144)       │               0 │ block_2_expand_BN[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_2_depthwise             │ (None, 56, 56, 144)       │           1,296 │ block_2_expand_relu[0][0]  │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_2_depthwise_BN          │ (None, 56, 56, 144)       │             576 │ block_2_depthwise[0][0]    │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_2_depthwise_relu (ReLU) │ (None, 56, 56, 144)       │               0 │ block_2_depthwise_BN[0][0] │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_2_project (Conv2D)      │ (None, 56, 56, 24)        │           3,456 │ block_2_depthwise_relu[0]… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_2_project_BN            │ (None, 56, 56, 24)        │              96 │ block_2_project[0][0]      │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_2_add (Add)             │ (None, 56, 56, 24)        │               0 │ block_1_project_BN[0][0],  │
│                               │                           │                 │ block_2_project_BN[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_3_expand (Conv2D)       │ (None, 56, 56, 144)       │           3,456 │ block_2_add[0][0]          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_3_expand_BN             │ (None, 56, 56, 144)       │             576 │ block_3_expand[0][0]       │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_3_expand_relu (ReLU)    │ (None, 56, 56, 144)       │               0 │ block_3_expand_BN[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_3_pad (ZeroPadding2D)   │ (None, 57, 57, 144)       │               0 │ block_3_expand_relu[0][0]  │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_3_depthwise             │ (None, 28, 28, 144)       │           1,296 │ block_3_pad[0][0]          │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_3_depthwise_BN          │ (None, 28, 28, 144)       │             576 │ block_3_depthwise[0][0]    │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_3_depthwise_relu (ReLU) │ (None, 28, 28, 144)       │               0 │ block_3_depthwise_BN[0][0] │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_3_project (Conv2D)      │ (None, 28, 28, 32)        │           4,608 │ block_3_depthwise_relu[0]… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_3_project_BN            │ (None, 28, 28, 32)        │             128 │ block_3_project[0][0]      │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_4_expand (Conv2D)       │ (None, 28, 28, 192)       │           6,144 │ block_3_project_BN[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_4_expand_BN             │ (None, 28, 28, 192)       │             768 │ block_4_expand[0][0]       │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_4_expand_relu (ReLU)    │ (None, 28, 28, 192)       │               0 │ block_4_expand_BN[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_4_depthwise             │ (None, 28, 28, 192)       │           1,728 │ block_4_expand_relu[0][0]  │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_4_depthwise_BN          │ (None, 28, 28, 192)       │             768 │ block_4_depthwise[0][0]    │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_4_depthwise_relu (ReLU) │ (None, 28, 28, 192)       │               0 │ block_4_depthwise_BN[0][0] │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_4_project (Conv2D)      │ (None, 28, 28, 32)        │           6,144 │ block_4_depthwise_relu[0]… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_4_project_BN            │ (None, 28, 28, 32)        │             128 │ block_4_project[0][0]      │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_4_add (Add)             │ (None, 28, 28, 32)        │               0 │ block_3_project_BN[0][0],  │
│                               │                           │                 │ block_4_project_BN[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_5_expand (Conv2D)       │ (None, 28, 28, 192)       │           6,144 │ block_4_add[0][0]          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_5_expand_BN             │ (None, 28, 28, 192)       │             768 │ block_5_expand[0][0]       │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_5_expand_relu (ReLU)    │ (None, 28, 28, 192)       │               0 │ block_5_expand_BN[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_5_depthwise             │ (None, 28, 28, 192)       │           1,728 │ block_5_expand_relu[0][0]  │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_5_depthwise_BN          │ (None, 28, 28, 192)       │             768 │ block_5_depthwise[0][0]    │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_5_depthwise_relu (ReLU) │ (None, 28, 28, 192)       │               0 │ block_5_depthwise_BN[0][0] │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_5_project (Conv2D)      │ (None, 28, 28, 32)        │           6,144 │ block_5_depthwise_relu[0]… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_5_project_BN            │ (None, 28, 28, 32)        │             128 │ block_5_project[0][0]      │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_5_add (Add)             │ (None, 28, 28, 32)        │               0 │ block_4_add[0][0],         │
│                               │                           │                 │ block_5_project_BN[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_6_expand (Conv2D)       │ (None, 28, 28, 192)       │           6,144 │ block_5_add[0][0]          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_6_expand_BN             │ (None, 28, 28, 192)       │             768 │ block_6_expand[0][0]       │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_6_expand_relu (ReLU)    │ (None, 28, 28, 192)       │               0 │ block_6_expand_BN[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_6_pad (ZeroPadding2D)   │ (None, 29, 29, 192)       │               0 │ block_6_expand_relu[0][0]  │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_6_depthwise             │ (None, 14, 14, 192)       │           1,728 │ block_6_pad[0][0]          │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_6_depthwise_BN          │ (None, 14, 14, 192)       │             768 │ block_6_depthwise[0][0]    │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_6_depthwise_relu (ReLU) │ (None, 14, 14, 192)       │               0 │ block_6_depthwise_BN[0][0] │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_6_project (Conv2D)      │ (None, 14, 14, 64)        │          12,288 │ block_6_depthwise_relu[0]… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_6_project_BN            │ (None, 14, 14, 64)        │             256 │ block_6_project[0][0]      │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_7_expand (Conv2D)       │ (None, 14, 14, 384)       │          24,576 │ block_6_project_BN[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_7_expand_BN             │ (None, 14, 14, 384)       │           1,536 │ block_7_expand[0][0]       │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_7_expand_relu (ReLU)    │ (None, 14, 14, 384)       │               0 │ block_7_expand_BN[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_7_depthwise             │ (None, 14, 14, 384)       │           3,456 │ block_7_expand_relu[0][0]  │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_7_depthwise_BN          │ (None, 14, 14, 384)       │           1,536 │ block_7_depthwise[0][0]    │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_7_depthwise_relu (ReLU) │ (None, 14, 14, 384)       │               0 │ block_7_depthwise_BN[0][0] │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_7_project (Conv2D)      │ (None, 14, 14, 64)        │          24,576 │ block_7_depthwise_relu[0]… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_7_project_BN            │ (None, 14, 14, 64)        │             256 │ block_7_project[0][0]      │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_7_add (Add)             │ (None, 14, 14, 64)        │               0 │ block_6_project_BN[0][0],  │
│                               │                           │                 │ block_7_project_BN[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_8_expand (Conv2D)       │ (None, 14, 14, 384)       │          24,576 │ block_7_add[0][0]          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_8_expand_BN             │ (None, 14, 14, 384)       │           1,536 │ block_8_expand[0][0]       │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_8_expand_relu (ReLU)    │ (None, 14, 14, 384)       │               0 │ block_8_expand_BN[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_8_depthwise             │ (None, 14, 14, 384)       │           3,456 │ block_8_expand_relu[0][0]  │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_8_depthwise_BN          │ (None, 14, 14, 384)       │           1,536 │ block_8_depthwise[0][0]    │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_8_depthwise_relu (ReLU) │ (None, 14, 14, 384)       │               0 │ block_8_depthwise_BN[0][0] │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_8_project (Conv2D)      │ (None, 14, 14, 64)        │          24,576 │ block_8_depthwise_relu[0]… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_8_project_BN            │ (None, 14, 14, 64)        │             256 │ block_8_project[0][0]      │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_8_add (Add)             │ (None, 14, 14, 64)        │               0 │ block_7_add[0][0],         │
│                               │                           │                 │ block_8_project_BN[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_9_expand (Conv2D)       │ (None, 14, 14, 384)       │          24,576 │ block_8_add[0][0]          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_9_expand_BN             │ (None, 14, 14, 384)       │           1,536 │ block_9_expand[0][0]       │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_9_expand_relu (ReLU)    │ (None, 14, 14, 384)       │               0 │ block_9_expand_BN[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_9_depthwise             │ (None, 14, 14, 384)       │           3,456 │ block_9_expand_relu[0][0]  │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_9_depthwise_BN          │ (None, 14, 14, 384)       │           1,536 │ block_9_depthwise[0][0]    │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_9_depthwise_relu (ReLU) │ (None, 14, 14, 384)       │               0 │ block_9_depthwise_BN[0][0] │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_9_project (Conv2D)      │ (None, 14, 14, 64)        │          24,576 │ block_9_depthwise_relu[0]… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_9_project_BN            │ (None, 14, 14, 64)        │             256 │ block_9_project[0][0]      │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_9_add (Add)             │ (None, 14, 14, 64)        │               0 │ block_8_add[0][0],         │
│                               │                           │                 │ block_9_project_BN[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_10_expand (Conv2D)      │ (None, 14, 14, 384)       │          24,576 │ block_9_add[0][0]          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_10_expand_BN            │ (None, 14, 14, 384)       │           1,536 │ block_10_expand[0][0]      │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_10_expand_relu (ReLU)   │ (None, 14, 14, 384)       │               0 │ block_10_expand_BN[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_10_depthwise            │ (None, 14, 14, 384)       │           3,456 │ block_10_expand_relu[0][0] │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_10_depthwise_BN         │ (None, 14, 14, 384)       │           1,536 │ block_10_depthwise[0][0]   │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_10_depthwise_relu       │ (None, 14, 14, 384)       │               0 │ block_10_depthwise_BN[0][… │
│ (ReLU)                        │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_10_project (Conv2D)     │ (None, 14, 14, 96)        │          36,864 │ block_10_depthwise_relu[0… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_10_project_BN           │ (None, 14, 14, 96)        │             384 │ block_10_project[0][0]     │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_11_expand (Conv2D)      │ (None, 14, 14, 576)       │          55,296 │ block_10_project_BN[0][0]  │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_11_expand_BN            │ (None, 14, 14, 576)       │           2,304 │ block_11_expand[0][0]      │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_11_expand_relu (ReLU)   │ (None, 14, 14, 576)       │               0 │ block_11_expand_BN[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_11_depthwise            │ (None, 14, 14, 576)       │           5,184 │ block_11_expand_relu[0][0] │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_11_depthwise_BN         │ (None, 14, 14, 576)       │           2,304 │ block_11_depthwise[0][0]   │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_11_depthwise_relu       │ (None, 14, 14, 576)       │               0 │ block_11_depthwise_BN[0][… │
│ (ReLU)                        │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_11_project (Conv2D)     │ (None, 14, 14, 96)        │          55,296 │ block_11_depthwise_relu[0… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_11_project_BN           │ (None, 14, 14, 96)        │             384 │ block_11_project[0][0]     │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_11_add (Add)            │ (None, 14, 14, 96)        │               0 │ block_10_project_BN[0][0], │
│                               │                           │                 │ block_11_project_BN[0][0]  │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_12_expand (Conv2D)      │ (None, 14, 14, 576)       │          55,296 │ block_11_add[0][0]         │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_12_expand_BN            │ (None, 14, 14, 576)       │           2,304 │ block_12_expand[0][0]      │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_12_expand_relu (ReLU)   │ (None, 14, 14, 576)       │               0 │ block_12_expand_BN[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_12_depthwise            │ (None, 14, 14, 576)       │           5,184 │ block_12_expand_relu[0][0] │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_12_depthwise_BN         │ (None, 14, 14, 576)       │           2,304 │ block_12_depthwise[0][0]   │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_12_depthwise_relu       │ (None, 14, 14, 576)       │               0 │ block_12_depthwise_BN[0][… │
│ (ReLU)                        │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_12_project (Conv2D)     │ (None, 14, 14, 96)        │          55,296 │ block_12_depthwise_relu[0… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_12_project_BN           │ (None, 14, 14, 96)        │             384 │ block_12_project[0][0]     │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_12_add (Add)            │ (None, 14, 14, 96)        │               0 │ block_11_add[0][0],        │
│                               │                           │                 │ block_12_project_BN[0][0]  │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_13_expand (Conv2D)      │ (None, 14, 14, 576)       │          55,296 │ block_12_add[0][0]         │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_13_expand_BN            │ (None, 14, 14, 576)       │           2,304 │ block_13_expand[0][0]      │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_13_expand_relu (ReLU)   │ (None, 14, 14, 576)       │               0 │ block_13_expand_BN[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_13_pad (ZeroPadding2D)  │ (None, 15, 15, 576)       │               0 │ block_13_expand_relu[0][0] │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_13_depthwise            │ (None, 7, 7, 576)         │           5,184 │ block_13_pad[0][0]         │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_13_depthwise_BN         │ (None, 7, 7, 576)         │           2,304 │ block_13_depthwise[0][0]   │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_13_depthwise_relu       │ (None, 7, 7, 576)         │               0 │ block_13_depthwise_BN[0][… │
│ (ReLU)                        │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_13_project (Conv2D)     │ (None, 7, 7, 160)         │          92,160 │ block_13_depthwise_relu[0… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_13_project_BN           │ (None, 7, 7, 160)         │             640 │ block_13_project[0][0]     │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_14_expand (Conv2D)      │ (None, 7, 7, 960)         │         153,600 │ block_13_project_BN[0][0]  │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_14_expand_BN            │ (None, 7, 7, 960)         │           3,840 │ block_14_expand[0][0]      │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_14_expand_relu (ReLU)   │ (None, 7, 7, 960)         │               0 │ block_14_expand_BN[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_14_depthwise            │ (None, 7, 7, 960)         │           8,640 │ block_14_expand_relu[0][0] │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_14_depthwise_BN         │ (None, 7, 7, 960)         │           3,840 │ block_14_depthwise[0][0]   │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_14_depthwise_relu       │ (None, 7, 7, 960)         │               0 │ block_14_depthwise_BN[0][… │
│ (ReLU)                        │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_14_project (Conv2D)     │ (None, 7, 7, 160)         │         153,600 │ block_14_depthwise_relu[0… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_14_project_BN           │ (None, 7, 7, 160)         │             640 │ block_14_project[0][0]     │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_14_add (Add)            │ (None, 7, 7, 160)         │               0 │ block_13_project_BN[0][0], │
│                               │                           │                 │ block_14_project_BN[0][0]  │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_15_expand (Conv2D)      │ (None, 7, 7, 960)         │         153,600 │ block_14_add[0][0]         │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_15_expand_BN            │ (None, 7, 7, 960)         │           3,840 │ block_15_expand[0][0]      │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_15_expand_relu (ReLU)   │ (None, 7, 7, 960)         │               0 │ block_15_expand_BN[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_15_depthwise            │ (None, 7, 7, 960)         │           8,640 │ block_15_expand_relu[0][0] │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_15_depthwise_BN         │ (None, 7, 7, 960)         │           3,840 │ block_15_depthwise[0][0]   │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_15_depthwise_relu       │ (None, 7, 7, 960)         │               0 │ block_15_depthwise_BN[0][… │
│ (ReLU)                        │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_15_project (Conv2D)     │ (None, 7, 7, 160)         │         153,600 │ block_15_depthwise_relu[0… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_15_project_BN           │ (None, 7, 7, 160)         │             640 │ block_15_project[0][0]     │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_15_add (Add)            │ (None, 7, 7, 160)         │               0 │ block_14_add[0][0],        │
│                               │                           │                 │ block_15_project_BN[0][0]  │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_16_expand (Conv2D)      │ (None, 7, 7, 960)         │         153,600 │ block_15_add[0][0]         │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_16_expand_BN            │ (None, 7, 7, 960)         │           3,840 │ block_16_expand[0][0]      │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_16_expand_relu (ReLU)   │ (None, 7, 7, 960)         │               0 │ block_16_expand_BN[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_16_depthwise            │ (None, 7, 7, 960)         │           8,640 │ block_16_expand_relu[0][0] │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_16_depthwise_BN         │ (None, 7, 7, 960)         │           3,840 │ block_16_depthwise[0][0]   │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_16_depthwise_relu       │ (None, 7, 7, 960)         │               0 │ block_16_depthwise_BN[0][… │
│ (ReLU)                        │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_16_project (Conv2D)     │ (None, 7, 7, 320)         │         307,200 │ block_16_depthwise_relu[0… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_16_project_BN           │ (None, 7, 7, 320)         │           1,280 │ block_16_project[0][0]     │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ Conv_1 (Conv2D)               │ (None, 7, 7, 1280)        │         409,600 │ block_16_project_BN[0][0]  │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ Conv_1_bn                     │ (None, 7, 7, 1280)        │           5,120 │ Conv_1[0][0]               │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ out_relu (ReLU)               │ (None, 7, 7, 1280)        │               0 │ Conv_1_bn[0][0]            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ global_average_pooling2d      │ (None, 1280)              │               0 │ out_relu[0][0]             │
│ (GlobalAveragePooling2D)      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ dense (Dense)                 │ (None, 128)               │         163,968 │ global_average_pooling2d[… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ batch_normalization           │ (None, 128)               │             512 │ dense[0][0]                │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ re_lu (ReLU)                  │ (None, 128)               │               0 │ batch_normalization[0][0]  │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ dropout (Dropout)             │ (None, 128)               │               0 │ re_lu[0][0]                │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ dense_1 (Dense)               │ (None, 64)                │           8,256 │ dropout[0][0]              │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ batch_normalization_1         │ (None, 64)                │             256 │ dense_1[0][0]              │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ re_lu_1 (ReLU)                │ (None, 64)                │               0 │ batch_normalization_1[0][… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ dense_2 (Dense)               │ (None, 3)                 │             195 │ re_lu_1[0][0]              │
└───────────────────────────────┴───────────────────────────┴─────────────────┴────────────────────────────┘
 Total params: 2,776,779 (10.59 MB)
 Trainable params: 172,803 (675.01 KB)
 Non-trainable params: 2,258,368 (8.61 MB)
 Optimizer params: 345,608 (1.32 MB)
✅ Model successfully converted and saved as drowsiness_detector.keras
/mnt/d/thien/model/mobilenetV2/mobilenetV2.py:90: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()


Epoch 1/20
241/241 ━━━━━━━━━━━━━━━━━━━━ 83s 336ms/step - accuracy: 0.5376 - loss: 0.9703 - val_accuracy: 0.7677 - val_loss: 0.6469
Epoch 2/20
241/241 ━━━━━━━━━━━━━━━━━━━━ 81s 334ms/step - accuracy: 0.7972 - loss: 0.5781 - val_accuracy: 0.8207 - val_loss: 0.4987
Epoch 3/20
241/241 ━━━━━━━━━━━━━━━━━━━━ 73s 304ms/step - accuracy: 0.8562 - loss: 0.4387 - val_accuracy: 0.8633 - val_loss: 0.4154
Epoch 4/20
241/241 ━━━━━━━━━━━━━━━━━━━━ 73s 304ms/step - accuracy: 0.8965 - loss: 0.3529 - val_accuracy: 0.8701 - val_loss: 0.3731
Epoch 5/20
241/241 ━━━━━━━━━━━━━━━━━━━━ 75s 309ms/step - accuracy: 0.9118 - loss: 0.3022 - val_accuracy: 0.8924 - val_loss: 0.3282
Epoch 6/20
241/241 ━━━━━━━━━━━━━━━━━━━━ 74s 307ms/step - accuracy: 0.9262 - loss: 0.2596 - val_accuracy: 0.9059 - val_loss: 0.3019
Epoch 7/20
241/241 ━━━━━━━━━━━━━━━━━━━━ 74s 309ms/step - accuracy: 0.9369 - loss: 0.2278 - val_accuracy: 0.9101 - val_loss: 0.2832
Epoch 8/20
241/241 ━━━━━━━━━━━━━━━━━━━━ 73s 304ms/step - accuracy: 0.9458 - loss: 0.2063 - val_accuracy: 0.9168 - val_loss: 0.2620
Epoch 9/20
241/241 ━━━━━━━━━━━━━━━━━━━━ 73s 304ms/step - accuracy: 0.9505 - loss: 0.1880 - val_accuracy: 0.9174 - val_loss: 0.2509
Epoch 10/20
241/241 ━━━━━━━━━━━━━━━━━━━━ 73s 305ms/step - accuracy: 0.9550 - loss: 0.1699 - val_accuracy: 0.9205 - val_loss: 0.2392
Epoch 11/20
241/241 ━━━━━━━━━━━━━━━━━━━━ 74s 307ms/step - accuracy: 0.9562 - loss: 0.1569 - val_accuracy: 0.9215 - val_loss: 0.2335
Epoch 12/20
241/241 ━━━━━━━━━━━━━━━━━━━━ 74s 309ms/step - accuracy: 0.9631 - loss: 0.1436 - val_accuracy: 0.9200 - val_loss: 0.2276
Epoch 13/20
241/241 ━━━━━━━━━━━━━━━━━━━━ 76s 316ms/step - accuracy: 0.9661 - loss: 0.1307 - val_accuracy: 0.9257 - val_loss: 0.2152
Epoch 14/20
241/241 ━━━━━━━━━━━━━━━━━━━━ 74s 308ms/step - accuracy: 0.9687 - loss: 0.1220 - val_accuracy: 0.9283 - val_loss: 0.2070
Epoch 15/20
241/241 ━━━━━━━━━━━━━━━━━━━━ 74s 307ms/step - accuracy: 0.9746 - loss: 0.1112 - val_accuracy: 0.9278 - val_loss: 0.2061
Epoch 16/20
241/241 ━━━━━━━━━━━━━━━━━━━━ 74s 307ms/step - accuracy: 0.9766 - loss: 0.1033 - val_accuracy: 0.9288 - val_loss: 0.2051
Epoch 17/20
241/241 ━━━━━━━━━━━━━━━━━━━━ 74s 307ms/step - accuracy: 0.9788 - loss: 0.0978 - val_accuracy: 0.9335 - val_loss: 0.1951
Epoch 18/20
241/241 ━━━━━━━━━━━━━━━━━━━━ 74s 306ms/step - accuracy: 0.9799 - loss: 0.0909 - val_accuracy: 0.9340 - val_loss: 0.1933
Epoch 19/20
241/241 ━━━━━━━━━━━━━━━━━━━━ 76s 317ms/step - accuracy: 0.9824 - loss: 0.0832 - val_accuracy: 0.9350 - val_loss: 0.1900
Epoch 20/20
241/241 ━━━━━━━━━━━━━━━━━━━━ 75s 309ms/step - accuracy: 0.9845 - loss: 0.0783 - val_accuracy: 0.9361 - val_loss: 0.1850
Saved artifact at '/tmp/tmprlwyi6oa'. The following endpoints are available:

* Endpoint 'serve'
  args_0 (POSITIONAL_ONLY): TensorSpec(shape=(None, 224, 224, 3), dtype=tf.float32, name='keras_tensor')
Output Type:
  TensorSpec(shape=(None, 3), dtype=tf.float32, name=None)
Captures:
  139743799352432: TensorSpec(shape=(), dtype=tf.resource, name=None)
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
W0000 00:00:1744608518.900789   57731 tf_tfl_flatbuffer_helpers.cc:365] Ignored output_format.
W0000 00:00:1744608518.900895   57731 tf_tfl_flatbuffer_helpers.cc:368] Ignored drop_control_dependency.
2025-04-14 12:28:38.901476: I tensorflow/cc/saved_model/reader.cc:83] Reading SavedModel from: /tmp/tmprlwyi6oa
2025-04-14 12:28:38.908739: I tensorflow/cc/saved_model/reader.cc:52] Reading meta graph with tags { serve }
2025-04-14 12:28:38.908767: I tensorflow/cc/saved_model/reader.cc:147] Reading SavedModel debug info (if present) from: /tmp/tmprlwyi6oa
I0000 00:00:1744608518.976187   57731 mlir_graph_optimization_pass.cc:425] MLIR V1 optimization pass is not enabled
2025-04-14 12:28:38.988121: I tensorflow/cc/saved_model/loader.cc:236] Restoring SavedModel bundle.
2025-04-14 12:28:39.381306: I tensorflow/cc/saved_model/loader.cc:220] Running initialization op on SavedModel bundle at path: /tmp/tmprlwyi6oa
2025-04-14 12:28:39.489772: I tensorflow/cc/saved_model/loader.cc:471] SavedModel load for tags { serve }; Status: success: OK. Took 588262 microseconds.
2025-04-14 12:28:39.615065: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:269] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
Model: "functional"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                  ┃ Output Shape              ┃         Param # ┃ Connected to               ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ input_layer (InputLayer)      │ (None, 224, 224, 3)       │               0 │ -                          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ rescaling (Rescaling)         │ (None, 224, 224, 3)       │               0 │ input_layer[0][0]          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ conv (Conv2D)                 │ (None, 112, 112, 16)      │             432 │ rescaling[0][0]            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ conv_bn (BatchNormalization)  │ (None, 112, 112, 16)      │              64 │ conv[0][0]                 │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ activation (Activation)       │ (None, 112, 112, 16)      │               0 │ conv_bn[0][0]              │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_depthwise       │ (None, 112, 112, 16)      │             144 │ activation[0][0]           │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_depthwise_bn    │ (None, 112, 112, 16)      │              64 │ expanded_conv_depthwise[0… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ re_lu (ReLU)                  │ (None, 112, 112, 16)      │               0 │ expanded_conv_depthwise_b… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_project         │ (None, 112, 112, 16)      │             256 │ re_lu[0][0]                │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_project_bn      │ (None, 112, 112, 16)      │              64 │ expanded_conv_project[0][… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_add (Add)       │ (None, 112, 112, 16)      │               0 │ activation[0][0],          │
│                               │                           │                 │ expanded_conv_project_bn[… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_1_expand        │ (None, 112, 112, 64)      │           1,024 │ expanded_conv_add[0][0]    │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_1_expand_bn     │ (None, 112, 112, 64)      │             256 │ expanded_conv_1_expand[0]… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ re_lu_1 (ReLU)                │ (None, 112, 112, 64)      │               0 │ expanded_conv_1_expand_bn… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_1_depthwise_pad │ (None, 113, 113, 64)      │               0 │ re_lu_1[0][0]              │
│ (ZeroPadding2D)               │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_1_depthwise     │ (None, 56, 56, 64)        │             576 │ expanded_conv_1_depthwise… │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_1_depthwise_bn  │ (None, 56, 56, 64)        │             256 │ expanded_conv_1_depthwise… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ re_lu_2 (ReLU)                │ (None, 56, 56, 64)        │               0 │ expanded_conv_1_depthwise… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_1_project       │ (None, 56, 56, 24)        │           1,536 │ re_lu_2[0][0]              │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_1_project_bn    │ (None, 56, 56, 24)        │              96 │ expanded_conv_1_project[0… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_2_expand        │ (None, 56, 56, 72)        │           1,728 │ expanded_conv_1_project_b… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_2_expand_bn     │ (None, 56, 56, 72)        │             288 │ expanded_conv_2_expand[0]… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ re_lu_3 (ReLU)                │ (None, 56, 56, 72)        │               0 │ expanded_conv_2_expand_bn… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_2_depthwise     │ (None, 56, 56, 72)        │             648 │ re_lu_3[0][0]              │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_2_depthwise_bn  │ (None, 56, 56, 72)        │             288 │ expanded_conv_2_depthwise… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ re_lu_4 (ReLU)                │ (None, 56, 56, 72)        │               0 │ expanded_conv_2_depthwise… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_2_project       │ (None, 56, 56, 24)        │           1,728 │ re_lu_4[0][0]              │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_2_project_bn    │ (None, 56, 56, 24)        │              96 │ expanded_conv_2_project[0… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_2_add (Add)     │ (None, 56, 56, 24)        │               0 │ expanded_conv_1_project_b… │
│                               │                           │                 │ expanded_conv_2_project_b… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_3_expand        │ (None, 56, 56, 72)        │           1,728 │ expanded_conv_2_add[0][0]  │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_3_expand_bn     │ (None, 56, 56, 72)        │             288 │ expanded_conv_3_expand[0]… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ re_lu_5 (ReLU)                │ (None, 56, 56, 72)        │               0 │ expanded_conv_3_expand_bn… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_3_depthwise_pad │ (None, 59, 59, 72)        │               0 │ re_lu_5[0][0]              │
│ (ZeroPadding2D)               │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_3_depthwise     │ (None, 28, 28, 72)        │           1,800 │ expanded_conv_3_depthwise… │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_3_depthwise_bn  │ (None, 28, 28, 72)        │             288 │ expanded_conv_3_depthwise… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ re_lu_6 (ReLU)                │ (None, 28, 28, 72)        │               0 │ expanded_conv_3_depthwise… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_3_squeeze_exci… │ (None, 1, 1, 72)          │               0 │ re_lu_6[0][0]              │
│ (GlobalAveragePooling2D)      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_3_squeeze_exci… │ (None, 1, 1, 24)          │           1,752 │ expanded_conv_3_squeeze_e… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_3_squeeze_exci… │ (None, 1, 1, 24)          │               0 │ expanded_conv_3_squeeze_e… │
│ (ReLU)                        │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_3_squeeze_exci… │ (None, 1, 1, 72)          │           1,800 │ expanded_conv_3_squeeze_e… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ add (Add)                     │ (None, 1, 1, 72)          │               0 │ expanded_conv_3_squeeze_e… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ re_lu_7 (ReLU)                │ (None, 1, 1, 72)          │               0 │ add[0][0]                  │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ multiply (Multiply)           │ (None, 1, 1, 72)          │               0 │ re_lu_7[0][0]              │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_3_squeeze_exci… │ (None, 28, 28, 72)        │               0 │ re_lu_6[0][0],             │
│ (Multiply)                    │                           │                 │ multiply[0][0]             │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_3_project       │ (None, 28, 28, 40)        │           2,880 │ expanded_conv_3_squeeze_e… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_3_project_bn    │ (None, 28, 28, 40)        │             160 │ expanded_conv_3_project[0… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_4_expand        │ (None, 28, 28, 120)       │           4,800 │ expanded_conv_3_project_b… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_4_expand_bn     │ (None, 28, 28, 120)       │             480 │ expanded_conv_4_expand[0]… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ re_lu_8 (ReLU)                │ (None, 28, 28, 120)       │               0 │ expanded_conv_4_expand_bn… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_4_depthwise     │ (None, 28, 28, 120)       │           3,000 │ re_lu_8[0][0]              │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_4_depthwise_bn  │ (None, 28, 28, 120)       │             480 │ expanded_conv_4_depthwise… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ re_lu_9 (ReLU)                │ (None, 28, 28, 120)       │               0 │ expanded_conv_4_depthwise… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_4_squeeze_exci… │ (None, 1, 1, 120)         │               0 │ re_lu_9[0][0]              │
│ (GlobalAveragePooling2D)      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_4_squeeze_exci… │ (None, 1, 1, 32)          │           3,872 │ expanded_conv_4_squeeze_e… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_4_squeeze_exci… │ (None, 1, 1, 32)          │               0 │ expanded_conv_4_squeeze_e… │
│ (ReLU)                        │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_4_squeeze_exci… │ (None, 1, 1, 120)         │           3,960 │ expanded_conv_4_squeeze_e… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ add_1 (Add)                   │ (None, 1, 1, 120)         │               0 │ expanded_conv_4_squeeze_e… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ re_lu_10 (ReLU)               │ (None, 1, 1, 120)         │               0 │ add_1[0][0]                │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ multiply_1 (Multiply)         │ (None, 1, 1, 120)         │               0 │ re_lu_10[0][0]             │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_4_squeeze_exci… │ (None, 28, 28, 120)       │               0 │ re_lu_9[0][0],             │
│ (Multiply)                    │                           │                 │ multiply_1[0][0]           │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_4_project       │ (None, 28, 28, 40)        │           4,800 │ expanded_conv_4_squeeze_e… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_4_project_bn    │ (None, 28, 28, 40)        │             160 │ expanded_conv_4_project[0… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_4_add (Add)     │ (None, 28, 28, 40)        │               0 │ expanded_conv_3_project_b… │
│                               │                           │                 │ expanded_conv_4_project_b… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_5_expand        │ (None, 28, 28, 120)       │           4,800 │ expanded_conv_4_add[0][0]  │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_5_expand_bn     │ (None, 28, 28, 120)       │             480 │ expanded_conv_5_expand[0]… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ re_lu_11 (ReLU)               │ (None, 28, 28, 120)       │               0 │ expanded_conv_5_expand_bn… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_5_depthwise     │ (None, 28, 28, 120)       │           3,000 │ re_lu_11[0][0]             │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_5_depthwise_bn  │ (None, 28, 28, 120)       │             480 │ expanded_conv_5_depthwise… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ re_lu_12 (ReLU)               │ (None, 28, 28, 120)       │               0 │ expanded_conv_5_depthwise… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_5_squeeze_exci… │ (None, 1, 1, 120)         │               0 │ re_lu_12[0][0]             │
│ (GlobalAveragePooling2D)      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_5_squeeze_exci… │ (None, 1, 1, 32)          │           3,872 │ expanded_conv_5_squeeze_e… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_5_squeeze_exci… │ (None, 1, 1, 32)          │               0 │ expanded_conv_5_squeeze_e… │
│ (ReLU)                        │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_5_squeeze_exci… │ (None, 1, 1, 120)         │           3,960 │ expanded_conv_5_squeeze_e… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ add_2 (Add)                   │ (None, 1, 1, 120)         │               0 │ expanded_conv_5_squeeze_e… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ re_lu_13 (ReLU)               │ (None, 1, 1, 120)         │               0 │ add_2[0][0]                │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ multiply_2 (Multiply)         │ (None, 1, 1, 120)         │               0 │ re_lu_13[0][0]             │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_5_squeeze_exci… │ (None, 28, 28, 120)       │               0 │ re_lu_12[0][0],            │
│ (Multiply)                    │                           │                 │ multiply_2[0][0]           │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_5_project       │ (None, 28, 28, 40)        │           4,800 │ expanded_conv_5_squeeze_e… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_5_project_bn    │ (None, 28, 28, 40)        │             160 │ expanded_conv_5_project[0… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_5_add (Add)     │ (None, 28, 28, 40)        │               0 │ expanded_conv_4_add[0][0], │
│                               │                           │                 │ expanded_conv_5_project_b… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_6_expand        │ (None, 28, 28, 240)       │           9,600 │ expanded_conv_5_add[0][0]  │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_6_expand_bn     │ (None, 28, 28, 240)       │             960 │ expanded_conv_6_expand[0]… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ activation_1 (Activation)     │ (None, 28, 28, 240)       │               0 │ expanded_conv_6_expand_bn… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_6_depthwise_pad │ (None, 29, 29, 240)       │               0 │ activation_1[0][0]         │
│ (ZeroPadding2D)               │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_6_depthwise     │ (None, 14, 14, 240)       │           2,160 │ expanded_conv_6_depthwise… │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_6_depthwise_bn  │ (None, 14, 14, 240)       │             960 │ expanded_conv_6_depthwise… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ activation_2 (Activation)     │ (None, 14, 14, 240)       │               0 │ expanded_conv_6_depthwise… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_6_project       │ (None, 14, 14, 80)        │          19,200 │ activation_2[0][0]         │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_6_project_bn    │ (None, 14, 14, 80)        │             320 │ expanded_conv_6_project[0… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_7_expand        │ (None, 14, 14, 200)       │          16,000 │ expanded_conv_6_project_b… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_7_expand_bn     │ (None, 14, 14, 200)       │             800 │ expanded_conv_7_expand[0]… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ activation_3 (Activation)     │ (None, 14, 14, 200)       │               0 │ expanded_conv_7_expand_bn… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_7_depthwise     │ (None, 14, 14, 200)       │           1,800 │ activation_3[0][0]         │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_7_depthwise_bn  │ (None, 14, 14, 200)       │             800 │ expanded_conv_7_depthwise… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ activation_4 (Activation)     │ (None, 14, 14, 200)       │               0 │ expanded_conv_7_depthwise… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_7_project       │ (None, 14, 14, 80)        │          16,000 │ activation_4[0][0]         │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_7_project_bn    │ (None, 14, 14, 80)        │             320 │ expanded_conv_7_project[0… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_7_add (Add)     │ (None, 14, 14, 80)        │               0 │ expanded_conv_6_project_b… │
│                               │                           │                 │ expanded_conv_7_project_b… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_8_expand        │ (None, 14, 14, 184)       │          14,720 │ expanded_conv_7_add[0][0]  │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_8_expand_bn     │ (None, 14, 14, 184)       │             736 │ expanded_conv_8_expand[0]… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ activation_5 (Activation)     │ (None, 14, 14, 184)       │               0 │ expanded_conv_8_expand_bn… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_8_depthwise     │ (None, 14, 14, 184)       │           1,656 │ activation_5[0][0]         │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_8_depthwise_bn  │ (None, 14, 14, 184)       │             736 │ expanded_conv_8_depthwise… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ activation_6 (Activation)     │ (None, 14, 14, 184)       │               0 │ expanded_conv_8_depthwise… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_8_project       │ (None, 14, 14, 80)        │          14,720 │ activation_6[0][0]         │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_8_project_bn    │ (None, 14, 14, 80)        │             320 │ expanded_conv_8_project[0… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_8_add (Add)     │ (None, 14, 14, 80)        │               0 │ expanded_conv_7_add[0][0], │
│                               │                           │                 │ expanded_conv_8_project_b… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_9_expand        │ (None, 14, 14, 184)       │          14,720 │ expanded_conv_8_add[0][0]  │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_9_expand_bn     │ (None, 14, 14, 184)       │             736 │ expanded_conv_9_expand[0]… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ activation_7 (Activation)     │ (None, 14, 14, 184)       │               0 │ expanded_conv_9_expand_bn… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_9_depthwise     │ (None, 14, 14, 184)       │           1,656 │ activation_7[0][0]         │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_9_depthwise_bn  │ (None, 14, 14, 184)       │             736 │ expanded_conv_9_depthwise… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ activation_8 (Activation)     │ (None, 14, 14, 184)       │               0 │ expanded_conv_9_depthwise… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_9_project       │ (None, 14, 14, 80)        │          14,720 │ activation_8[0][0]         │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_9_project_bn    │ (None, 14, 14, 80)        │             320 │ expanded_conv_9_project[0… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_9_add (Add)     │ (None, 14, 14, 80)        │               0 │ expanded_conv_8_add[0][0], │
│                               │                           │                 │ expanded_conv_9_project_b… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_10_expand       │ (None, 14, 14, 480)       │          38,400 │ expanded_conv_9_add[0][0]  │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_10_expand_bn    │ (None, 14, 14, 480)       │           1,920 │ expanded_conv_10_expand[0… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ activation_9 (Activation)     │ (None, 14, 14, 480)       │               0 │ expanded_conv_10_expand_b… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_10_depthwise    │ (None, 14, 14, 480)       │           4,320 │ activation_9[0][0]         │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_10_depthwise_bn │ (None, 14, 14, 480)       │           1,920 │ expanded_conv_10_depthwis… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ activation_10 (Activation)    │ (None, 14, 14, 480)       │               0 │ expanded_conv_10_depthwis… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_10_squeeze_exc… │ (None, 1, 1, 480)         │               0 │ activation_10[0][0]        │
│ (GlobalAveragePooling2D)      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_10_squeeze_exc… │ (None, 1, 1, 120)         │          57,720 │ expanded_conv_10_squeeze_… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_10_squeeze_exc… │ (None, 1, 1, 120)         │               0 │ expanded_conv_10_squeeze_… │
│ (ReLU)                        │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_10_squeeze_exc… │ (None, 1, 1, 480)         │          58,080 │ expanded_conv_10_squeeze_… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ add_3 (Add)                   │ (None, 1, 1, 480)         │               0 │ expanded_conv_10_squeeze_… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ re_lu_14 (ReLU)               │ (None, 1, 1, 480)         │               0 │ add_3[0][0]                │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ multiply_3 (Multiply)         │ (None, 1, 1, 480)         │               0 │ re_lu_14[0][0]             │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_10_squeeze_exc… │ (None, 14, 14, 480)       │               0 │ activation_10[0][0],       │
│ (Multiply)                    │                           │                 │ multiply_3[0][0]           │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_10_project      │ (None, 14, 14, 112)       │          53,760 │ expanded_conv_10_squeeze_… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_10_project_bn   │ (None, 14, 14, 112)       │             448 │ expanded_conv_10_project[… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_11_expand       │ (None, 14, 14, 672)       │          75,264 │ expanded_conv_10_project_… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_11_expand_bn    │ (None, 14, 14, 672)       │           2,688 │ expanded_conv_11_expand[0… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ activation_11 (Activation)    │ (None, 14, 14, 672)       │               0 │ expanded_conv_11_expand_b… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_11_depthwise    │ (None, 14, 14, 672)       │           6,048 │ activation_11[0][0]        │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_11_depthwise_bn │ (None, 14, 14, 672)       │           2,688 │ expanded_conv_11_depthwis… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ activation_12 (Activation)    │ (None, 14, 14, 672)       │               0 │ expanded_conv_11_depthwis… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_11_squeeze_exc… │ (None, 1, 1, 672)         │               0 │ activation_12[0][0]        │
│ (GlobalAveragePooling2D)      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_11_squeeze_exc… │ (None, 1, 1, 168)         │         113,064 │ expanded_conv_11_squeeze_… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_11_squeeze_exc… │ (None, 1, 1, 168)         │               0 │ expanded_conv_11_squeeze_… │
│ (ReLU)                        │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_11_squeeze_exc… │ (None, 1, 1, 672)         │         113,568 │ expanded_conv_11_squeeze_… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ add_4 (Add)                   │ (None, 1, 1, 672)         │               0 │ expanded_conv_11_squeeze_… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ re_lu_15 (ReLU)               │ (None, 1, 1, 672)         │               0 │ add_4[0][0]                │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ multiply_4 (Multiply)         │ (None, 1, 1, 672)         │               0 │ re_lu_15[0][0]             │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_11_squeeze_exc… │ (None, 14, 14, 672)       │               0 │ activation_12[0][0],       │
│ (Multiply)                    │                           │                 │ multiply_4[0][0]           │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_11_project      │ (None, 14, 14, 112)       │          75,264 │ expanded_conv_11_squeeze_… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_11_project_bn   │ (None, 14, 14, 112)       │             448 │ expanded_conv_11_project[… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_11_add (Add)    │ (None, 14, 14, 112)       │               0 │ expanded_conv_10_project_… │
│                               │                           │                 │ expanded_conv_11_project_… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_12_expand       │ (None, 14, 14, 672)       │          75,264 │ expanded_conv_11_add[0][0] │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_12_expand_bn    │ (None, 14, 14, 672)       │           2,688 │ expanded_conv_12_expand[0… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ activation_13 (Activation)    │ (None, 14, 14, 672)       │               0 │ expanded_conv_12_expand_b… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_12_depthwise_p… │ (None, 17, 17, 672)       │               0 │ activation_13[0][0]        │
│ (ZeroPadding2D)               │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_12_depthwise    │ (None, 7, 7, 672)         │          16,800 │ expanded_conv_12_depthwis… │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_12_depthwise_bn │ (None, 7, 7, 672)         │           2,688 │ expanded_conv_12_depthwis… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ activation_14 (Activation)    │ (None, 7, 7, 672)         │               0 │ expanded_conv_12_depthwis… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_12_squeeze_exc… │ (None, 1, 1, 672)         │               0 │ activation_14[0][0]        │
│ (GlobalAveragePooling2D)      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_12_squeeze_exc… │ (None, 1, 1, 168)         │         113,064 │ expanded_conv_12_squeeze_… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_12_squeeze_exc… │ (None, 1, 1, 168)         │               0 │ expanded_conv_12_squeeze_… │
│ (ReLU)                        │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_12_squeeze_exc… │ (None, 1, 1, 672)         │         113,568 │ expanded_conv_12_squeeze_… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ add_5 (Add)                   │ (None, 1, 1, 672)         │               0 │ expanded_conv_12_squeeze_… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ re_lu_16 (ReLU)               │ (None, 1, 1, 672)         │               0 │ add_5[0][0]                │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ multiply_5 (Multiply)         │ (None, 1, 1, 672)         │               0 │ re_lu_16[0][0]             │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_12_squeeze_exc… │ (None, 7, 7, 672)         │               0 │ activation_14[0][0],       │
│ (Multiply)                    │                           │                 │ multiply_5[0][0]           │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_12_project      │ (None, 7, 7, 160)         │         107,520 │ expanded_conv_12_squeeze_… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_12_project_bn   │ (None, 7, 7, 160)         │             640 │ expanded_conv_12_project[… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_13_expand       │ (None, 7, 7, 960)         │         153,600 │ expanded_conv_12_project_… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_13_expand_bn    │ (None, 7, 7, 960)         │           3,840 │ expanded_conv_13_expand[0… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ activation_15 (Activation)    │ (None, 7, 7, 960)         │               0 │ expanded_conv_13_expand_b… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_13_depthwise    │ (None, 7, 7, 960)         │          24,000 │ activation_15[0][0]        │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_13_depthwise_bn │ (None, 7, 7, 960)         │           3,840 │ expanded_conv_13_depthwis… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ activation_16 (Activation)    │ (None, 7, 7, 960)         │               0 │ expanded_conv_13_depthwis… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_13_squeeze_exc… │ (None, 1, 1, 960)         │               0 │ activation_16[0][0]        │
│ (GlobalAveragePooling2D)      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_13_squeeze_exc… │ (None, 1, 1, 240)         │         230,640 │ expanded_conv_13_squeeze_… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_13_squeeze_exc… │ (None, 1, 1, 240)         │               0 │ expanded_conv_13_squeeze_… │
│ (ReLU)                        │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_13_squeeze_exc… │ (None, 1, 1, 960)         │         231,360 │ expanded_conv_13_squeeze_… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ add_6 (Add)                   │ (None, 1, 1, 960)         │               0 │ expanded_conv_13_squeeze_… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ re_lu_17 (ReLU)               │ (None, 1, 1, 960)         │               0 │ add_6[0][0]                │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ multiply_6 (Multiply)         │ (None, 1, 1, 960)         │               0 │ re_lu_17[0][0]             │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_13_squeeze_exc… │ (None, 7, 7, 960)         │               0 │ activation_16[0][0],       │
│ (Multiply)                    │                           │                 │ multiply_6[0][0]           │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_13_project      │ (None, 7, 7, 160)         │         153,600 │ expanded_conv_13_squeeze_… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_13_project_bn   │ (None, 7, 7, 160)         │             640 │ expanded_conv_13_project[… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_13_add (Add)    │ (None, 7, 7, 160)         │               0 │ expanded_conv_12_project_… │
│                               │                           │                 │ expanded_conv_13_project_… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_14_expand       │ (None, 7, 7, 960)         │         153,600 │ expanded_conv_13_add[0][0] │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_14_expand_bn    │ (None, 7, 7, 960)         │           3,840 │ expanded_conv_14_expand[0… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ activation_17 (Activation)    │ (None, 7, 7, 960)         │               0 │ expanded_conv_14_expand_b… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_14_depthwise    │ (None, 7, 7, 960)         │          24,000 │ activation_17[0][0]        │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_14_depthwise_bn │ (None, 7, 7, 960)         │           3,840 │ expanded_conv_14_depthwis… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ activation_18 (Activation)    │ (None, 7, 7, 960)         │               0 │ expanded_conv_14_depthwis… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_14_squeeze_exc… │ (None, 1, 1, 960)         │               0 │ activation_18[0][0]        │
│ (GlobalAveragePooling2D)      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_14_squeeze_exc… │ (None, 1, 1, 240)         │         230,640 │ expanded_conv_14_squeeze_… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_14_squeeze_exc… │ (None, 1, 1, 240)         │               0 │ expanded_conv_14_squeeze_… │
│ (ReLU)                        │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_14_squeeze_exc… │ (None, 1, 1, 960)         │         231,360 │ expanded_conv_14_squeeze_… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ add_7 (Add)                   │ (None, 1, 1, 960)         │               0 │ expanded_conv_14_squeeze_… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ re_lu_18 (ReLU)               │ (None, 1, 1, 960)         │               0 │ add_7[0][0]                │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ multiply_7 (Multiply)         │ (None, 1, 1, 960)         │               0 │ re_lu_18[0][0]             │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_14_squeeze_exc… │ (None, 7, 7, 960)         │               0 │ activation_18[0][0],       │
│ (Multiply)                    │                           │                 │ multiply_7[0][0]           │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_14_project      │ (None, 7, 7, 160)         │         153,600 │ expanded_conv_14_squeeze_… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_14_project_bn   │ (None, 7, 7, 160)         │             640 │ expanded_conv_14_project[… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_14_add (Add)    │ (None, 7, 7, 160)         │               0 │ expanded_conv_13_add[0][0… │
│                               │                           │                 │ expanded_conv_14_project_… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ conv_1 (Conv2D)               │ (None, 7, 7, 960)         │         153,600 │ expanded_conv_14_add[0][0] │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ conv_1_bn                     │ (None, 7, 7, 960)         │           3,840 │ conv_1[0][0]               │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ activation_19 (Activation)    │ (None, 7, 7, 960)         │               0 │ conv_1_bn[0][0]            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ global_average_pooling2d      │ (None, 960)               │               0 │ activation_19[0][0]        │
│ (GlobalAveragePooling2D)      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ dense (Dense)                 │ (None, 128)               │         123,008 │ global_average_pooling2d[… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ dense_1 (Dense)               │ (None, 3)                 │             387 │ dense[0][0]                │
└───────────────────────────────┴───────────────────────────┴─────────────────┴────────────────────────────┘
 Total params: 3,366,539 (12.84 MB)
 Trainable params: 123,395 (482.01 KB)
 Non-trainable params: 2,996,352 (11.43 MB)
 Optimizer params: 246,792 (964.04 KB)
✅ Model successfully converted and saved as drowsiness_detector.keras
Traceback (most recent call last):
  File "/mnt/d/thien/model/mobilenetV3/mobilenetV3.py", line 101, in <module>
    plt.plot(history.history['accuracy'], label='Train Accuracy')
NameError: name 'plt' is not defined